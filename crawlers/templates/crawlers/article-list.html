{% extends "crawlers/base.html" %}
{% load staticfiles %}
{% load humanize %}

{% block title %}Crawled Articles - {{ sitename }}{% endblock %}

{% block search-placeholder %}{{result_title}}{% endblock %}
{% block search-action %}{% endblock %}

{% block tabs %}
<div class="pB-8">
	<div class="md-tabs">
		<div class="md-tabs__tab-bar">
			<div class="md-tabs__tab is-static">
				<span class="tab-label">Articles</span>
			</div>			
		{% for tab in query_tabs %}
			<a href="{{ tab.url }}" class="md-tabs__tab {{ tab.css }}" title="{{ tab.help_text }}">
				<span class="tab-label bL">{{ tab.name }}</span>
			</a>
		{% endfor %}
		</div>
	</div>
</div>
{% endblock %}
{% block breadcrumbs %}
<div class="pT-8 pB-8">
	<div class="_layout">
		<div class="breadcrumbs wFull">
			<a href="{% url 'crawlers:dashboard' %}">Crawled data</a>
			<span> / </span>
			<a href="{% url 'crawlers:article-list' %}">article</a>
			<span> / </span>
		</div>
	</div>
</div>
{% endblock %}
{% block main %}

	<section id="id-section-main" class="p-8">
		<div class="mdl-poetry__post mdl-grid">
			<div class="mdl-card bC-none mdl-cell mdl-cell--12-col">

{% if articles %} {% comment %} Display the list {% endcomment %}
				{% comment %} Pagination {% endcomment %}
				<div class="mdl-card__supporting-text stats-text">
					<span>{{ articles.paginator.count|intcomma }} results for </span>
					<strong>{{result_title}}</strong>
				</div>
				{% if articles.paginator.num_pages > 1 %}
				<div class="mdl-card__supporting-text pTB-0 mdl-color-text--grey-600">
					{% include "common/include/pagination.html" with obj_list=articles getvars=getvars only %}
				</div>
				{% endif %}
				
				{% comment %} Add to repository panel {% endcomment %}
				<div class="mdl-card wFull mH-auto mT-16">
					<div id="id-div-action" class="mdl-card__supporting-text">
						<form id="id-person-search" class="a-mdl-form">
							<div class="row aI-c fW-w jC-fs">
								<div class="mW-512 mR-16">
									{% include "crawlers/creator-select2.html" %}
								</div>
								<div class="tAr mT--16">
									<div class="mdl-button mdl-button--colored" 
										data-url="{% url 'crawlers:article-to-poetry' %}" id="id-add-article-btn">
										Add to poetry repository
									</div> 
								</div>
							</div>
						</form>
					</div>
					<div id="id-div-status" class="div-status row hidden">
						<div>
							<i id="id-status-icon" class="material-icons icon" role="presentation"></i>
						</div>
						<div id="id-status-text" class="">
							Status
						</div>
					</div>
					<div id="id-div-loading" class="hidden">
						<div id="p2" class="wFull mdl-progress mdl-js-progress mdl-progress__indeterminate"></div>									
					</div>
					<div class="tAr">
						<button id="id-add-btn" class="mdl-button mdl-button--colored hidden">
					    	Add to repository
						</button>
					</div>
					<div class="mdl-card__menu">
						<button id="id-cancel-btn" class="mdl-button mdl-button--icon">
				          <!--<i class="material-icons">close</i>-->
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" enable-background="new 0 0 24 24" width="22" height="22" style="fill: #616161;">
							    <path d="M 5.625 4.21875 L 4.21875 5.625 L 10.59375 12 L 4.21875 18.375 L 5.625 19.78125 L 12 13.40625 L 18.375 19.78125 L 19.78125 18.375 L 13.40625 12 L 19.78125 5.625 L 18.375 4.21875 L 12 10.59375 L 5.625 4.21875 z"/>
							</svg>
						</button>
					</div>
				</div>
				
				{% comment %} Article list table {% endcomment %}
				<div class="table--large mdl-color-text--grey-800 mB-16">
					<table class="mdl-data-table mdl-js-data-table mdl-data-table--selectable wSn">
						<thead>
							<tr>
						    	<th>ID</th>
						    	<th class="non-numeric">Title</th>
						    	<th class="non-numeric">Author</th>
						    	<th class="non-numeric">Source</th>
						    	<th>Added at</th>
						    	<th class="non-numeric" title="Article once has been added to Repository">Valid</th>						    	
						    </tr>
						</thead>
						<tbody id="id-tbody">
							{% for article in articles %}
							<tr data-id={{ article.id }}>
								<td>{{ forloop.counter }}</td>
								<td class="non-numeric fS16">
									<a href="{{article.get_absolute_url}}" title="View article">{{ article.get_title }}</a>
								</td>
								<td class="non-numeric fS16">
									<a href="{% url 'crawlers:author-list'%}/?q={{ article.get_author }}" title="Search in crawled authors">{{ article.get_author }}</a>
								</td>
								<td class="non-numeric">
									<a href="{{ article.get_source_url }}" title="Visit source" target="_blank">{{ article.get_source_name }}</a>
								</td>
								<td title="{{article.added_at}}">{{ article.added_at | date }}</td>
								<td class="non-numeric">
									{% if article.get_validity %}
									<a href="#" title="View in repository">{{ article.get_validity }}</a>
									{% endif %}
								</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
				{% comment %} Pagination {% endcomment %}
				{% if articles.paginator.num_pages > 1 %}
				<div class="mdl-card__supporting-text pTB-0 mdl-color-text--grey-600">
					{% include "common/include/pagination.html" with obj_list=articles getvars=getvars only %}
				</div>
				{% endif %}
{% else %}  {% comment %} Display the notification {% endcomment %}
				<div class="">
					<div class="search-stats">
						Sorry, no results for
					</div>
					<div class="search-title">
						<h3>{{result_title}}</h3>
					</div>
					<div class="search-stats oops-message">
					</div>
				</div>
{% endif %}
			</div>
		</div>
	</section>

{% endblock %}

{% block scripts %}
	{{ block.super }}
	{% include "crawlers/creator-select2-js.html" %}
	<script type="text/javascript" src="{% static 'js/crawlers/mk-poetry.js' %}"></script>
{% endblock %}
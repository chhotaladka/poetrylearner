{% extends "crawlers/base.html" %}
{% load staticfiles %}

{% block title %}
	{{ author.get_name }} - crawled author
{% endblock %}

{% block main %}

	<section id="id-section-main" class="p-8">
		<div class="mdl-poetry__post mdl-grid">
			
			<div id="id-author-card" class="mdl-card mdl-cell mdl-cell--4-col mdl-cell--8-col-tablet mdl-cell--top bS-1 wFull">
				<div class="nav-pannel mdl-card__actions">
					{% with prev_author=author.get_previous %}
					<a href="{% url 'crawlers:author-details' pk=prev_author.id %}">
						<button id="id-prev-btn" class="action-button" title="Previous Author {{prev_author.get_name}}">
			                <i class="material-icons md-36" role="presentation">arrow_back</i>			                
						</button>
					</a>
					{% endwith %}																		
					<div class="mdl-layout-spacer"></div>
					{% with next_author=author.get_next%}
					<a href="{% url 'crawlers:author-details' pk=next_author.id %}">
						<button id="id-next-btn" class="action-button" title="Next Author {{next_author.get_name}}">							
			                <i class="material-icons md-36" role="presentation">arrow_forward</i>			                
						</button>
					</a>
					{% endwith %}
					
				</div>	
				<div class="info-list mdl-card__supporting-text mdl-color-text--grey-500">					
						<div>ID <b>{{author.id}}</b></div>
						<div>Name: <span id="id-author-name">{{ author.get_name }}</span></div>
						<div>Birth: <span>{{ author.get_birth_date }}</span></div>
						<div>Death: <span>{{ author.get_death_date }}</span></div>						
						<div>
							<span>Reference	<a title="Visit the source to know more" href={{ author.source_url }} target="_blank">URL</a>
							(Source of the data)</span>
						</div>
						<div>Added at <span>{{ author.added_at }}</span></div>					
						<div>Validity <span id="id-validity">{{ author.valid }}</span></div>										
				</div>
				<div class="action-pannel mdl-card__actions mdl-card--border mdl-color-text--grey-700">
					<a href="{% url 'crawlers:article-list' %}?author={{ author.get_name }}">
						<button id="id-list-btn" class="action-button" title="List crawled articles by {{ author.get_name }}">
			                <i class="material-icons" role="presentation">list</i>
			                <span class="action-button__text mdl-badge mdl-badge--no-background" data-badge="{{ articles.total }}">List crawled articles</span>
						</button>
					</a>
					{% if author.get_validity %}				
					<button id="id-article-btn" data-url="{% url 'crawlers:author-add-snippet' pk=author.id %}" class="action-button" title="Add all new crawled articles to snippets">						
		                <i class="material-icons" role="presentation">playlist_add</i>
		                <span class="action-button__text mdl-badge mdl-badge--no-background" data-badge="{{ articles.new }}">Add crawled articles to snippets</span>		                
					</button>
					{% endif %}					
					{% if not author.get_validity %}
					{% comment %} Provide a button to add this author to main database i.e. projects.Author {% endcomment %}					
					<button id="id-add-btn" class="action-button" title="Add {{ author.get_name }} to main database">						
		                <i class="material-icons" role="presentation">person_add</i>
		                <span class="action-button__text">Add author to main db</span>		                
					</button>
					{% else %}
					{% comment %}  Auhtor is valid. So, there should be her/his entry in main database of Author i.e. projects.Author. Take me there {% endcomment %}
					<a href="{% url 'projects:author-list' %}?q={{ author.get_name }}">
						<button id="id-find-btn" class="action-button" title="Find {{ author.get_name }} in main database">						
			                <i class="material-icons" role="presentation">search</i>
			                <span class="action-button__text">Search this author in main db</span>		                
						</button>
					</a>				
					{% endif %}
					
				</div>
				<div id="id-div-action" class="action-pannel mdl-card__actions mdl-card--border hidden">
					<div class="mL-16">
				  		Add all crawled articles by {{author.get_name}} to snippets, which have not been added before.
					</div>
					<div class="mdl-layout-spacer"></div>					
					<button id="id-add-article-btn" class="mL-16 mR-16 mdl-button mdl-js-button mdl-button--raised mdl-button--colored">
						Add
					</button>
					<button id="id-cancel-btn" class="mL-16 mR-16 mdl-button mdl-js-button mdl-button--raised ">
						Cancel
					</button>						
									
				</div>
				<div id="id-div-status" class="status-pannel tAc mdl-card__actions mdl-card--border hidden">
					<div>
						<i id="id-status-icon" class="material-icons" role="presentation"></i>
					</div>
					<div id="id-status-text" class="">
						Status
					</div>
				</div>					
				<div id="id-div-loading" class="loading-bar mdl-card__actions mdl-card--border hidden">
					<div id="p2" class="wFull mdl-progress mdl-js-progress mdl-progress__indeterminate"></div>									
				</div>																		
			</div>

			<div id="id-div-form" class="mdl-card mdl-cell mdl-cell--8-col hidden">
			{% comment %} update the AJAX response of add-author request here {% endcomment %}	
				<div id="id-div-form-body" class="mdl-card__supporting-text">			
				</div>
				<div class="mdl-card__menu">
					<button class="mdl-button mdl-js-button mdl-button--icon" id="id-dismiss" title="Dismiss the form">
		              <i class="material-icons mdl-color-text--grey-600">close</i>
					</button>
				</div>		
			</div>
										
		</div>	
	</section>

{% endblock %}

{% block search-form-action %}
	{% url 'crawlers:author-list' %}
{% endblock %}

{% block page-title %}Author / {{ author.get_name }}{% endblock %}

{% block scripts %}
	{{ block.super }}
	{% if not author.get_validity %}
	<script type="text/javascript" src="{% static 'js/crawlers/author.js' %}"></script>
	{% else %}
	<script type="text/javascript" src="{% static 'js/crawlers/mk-snippet.js' %}"></script>
	{% endif %}		
{% endblock %}